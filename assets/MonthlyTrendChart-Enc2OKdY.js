import{u as _,a as j,b as $,R as L,V as m,j as a,U as d,q as D,D as l,C as u,k as w}from"./index-8lZlQ1VF.js";import{u as A}from"./useDateFormatter-CGYOy8qr.js";import{C as O,e as Y}from"./exportUtils-2mZb3xMg.js";import{W as g}from"./Widget-B4rx0ltk.js";import{c as F}from"./toast-CFIaTDC2.js";import{M as H,T as V,N as b}from"./CategoricalChart-D5qaWDFU.js";import{B,a as P,X as W,Y as k,b as y}from"./BarChart-DNk5vCLj.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./MenuItem-BWUw3nDk.js";const tt=()=>{const{transactions:x,viewPeriod:r,selectedMonth:o,selectedYear:i}=_(),{monthlyBreakdown:E}=j(x,r,o,i),{formatCurrency:p}=$(),{formatDate:T}=A(),s=L.useMemo(()=>{if(r===m.MONTHLY){const e=new Date(i,o,0).getDate(),t=[];for(let c=1;c<=e;c++){const R=new Date(i,o-1,c).toISOString().split("T")[0],f=x.filter(n=>n.date?n.date.startsWith(R):!1),S=f.filter(n=>n.type==="income").reduce((n,h)=>n+(h.amount||0),0),N=f.filter(n=>n.type==="expense").reduce((n,h)=>n+(h.amount||0),0);t.push({date:c,Income:S,Expense:N})}return t}return E.map(e=>{const t=`${e.year}-${String(e.month).padStart(2,"0")}-01`;return{month:T(t,"monthYear"),Income:e.income,Expense:e.expense}})},[x,r,o,i,E,T]),C=()=>{const e=s.map(t=>({Period:r===m.MONTHLY?`Day ${t.date}`:t.month,Income:t.Income,Expense:t.Expense,Net:t.Income-t.Expense}));Y(e,"monthly_trend")},M=()=>{const e=s.slice(0,l.PREVIEW_ITEMS).map(t=>`${r===m.MONTHLY?`Day ${t.date}`:t.month}: Income: ${u}${p(t.Income,{minimumFractionDigits:0,maximumFractionDigits:0})}, Expense: ${u}${p(t.Expense,{minimumFractionDigits:0,maximumFractionDigits:0})}`).join(`
`);F(`${d.MONTHLY_TREND} (showing first ${l.PREVIEW_ITEMS}):
${e}${s.length>l.PREVIEW_ITEMS?`
... and ${s.length-l.PREVIEW_ITEMS} more`:""}`,{autoClose:w.TOAST_DETAILS})},I=e=>`${u}${p(e,{minimumFractionDigits:0,maximumFractionDigits:0})}`;return s.length===0?a.jsx(g,{title:d.MONTHLY_TREND,onRefresh:()=>window.location.reload(),children:a.jsx("div",{className:"py-8 text-center",children:a.jsx("p",{className:"text-sm text-gray-600",children:d.NO_DATA_AVAILABLE})})}):a.jsx(g,{title:d.MONTHLY_TREND,onExport:C,onViewDetails:M,onRefresh:()=>window.location.reload(),children:a.jsx(O,{height:D.DEFAULT_CHART_HEIGHT,children:a.jsx(H,{width:"100%",height:"100%",children:a.jsxs(B,{data:s,margin:D.MARGIN,children:[a.jsx(P,{strokeDasharray:"3 3"}),a.jsx(W,{dataKey:r===m.MONTHLY?"date":"month",tick:{fontSize:12}}),a.jsx(k,{tickFormatter:I,tick:{fontSize:12}}),a.jsx(V,{formatter:e=>I(e),contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"}}),a.jsx(b,{}),a.jsx(y,{dataKey:"Income",fill:"#28b9b5",radius:[4,4,0,0]}),a.jsx(y,{dataKey:"Expense",fill:"#ff5049",radius:[4,4,0,0]})]})})})})};export{tt as default};
