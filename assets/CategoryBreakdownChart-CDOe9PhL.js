import{r as l,p as q,u as Re,a as Ce,b as me,R as De,K as je,q as Z,D as $,j as y,U as G,C as ve,k as Se}from"./index-8lZlQ1VF.js";import{C as we,e as _e}from"./exportUtils-2mZb3xMg.js";import{W as ne}from"./Widget-B4rx0ltk.js";import{c as Le}from"./toast-CFIaTDC2.js";import{h as A,aT as B,aU as Ne,aV as ke,aW as C,aX as Me,aY as Ke,aZ as pe,a_ as $e,a$ as We,A as T,b0 as Be,b1 as Fe,b2 as Ge,b3 as Ve,j as fe,b4 as Ue,b5 as Ye,b6 as ze,b7 as Ze,b8 as He,b9 as Xe,w as ge,a8 as qe,r as J,D as be,s as he,R as Je,ba as Qe,aj as ea,X as ye,u as Q,bb as aa,L as N,Z as Ae,Y as ee,x as ta,C as ra,J as na,an as ia,E as ie,i as le,a7 as V,bc as H,bd as la,d as oa,a1 as sa,a2 as ca,a3 as ua,be as da,bf as ma,a4 as va,I as pa,F as fa,bg as ga,ai as W,g as oe,bh as ba,ao as ha,ax as ya,bi as Aa,aO as Pa,aP as Ea,aQ as xa,aR as Oa,aS as Ia,K as Ta,M as Ra,T as Ca,N as Da}from"./CategoricalChart-D5qaWDFU.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./MenuItem-BWUw3nDk.js";var Pe=e=>e.graphicalItems.polarItems,ja=A([B,Ne],ke),U=A([Pe,C,ja],Me),Sa=A([U],Ke),Y=A([Sa,pe],$e),wa=A([Y,C,U],We);A([Y,C,U],(e,a,r)=>r.length>0?e.flatMap(t=>r.flatMap(n=>{var i,o=T(t,(i=a.dataKey)!==null&&i!==void 0?i:n.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(a==null?void 0:a.dataKey)!=null?e.map(t=>({value:T(t,a.dataKey),errorDomain:[]})):e.map(t=>({value:t,errorDomain:[]})));var se=()=>{},_a=A([Y,C,U,Be,B],Fe),La=A([C,Ge,Ve,se,_a,se,fe,B],Ue),Ee=A([C,fe,Y,wa,Ye,B,La],ze),Na=A([Ee,C,Ze],He);A([C,Ee,Na,B],Xe);function ce(e,a){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function ue(e){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?ce(Object(r),!0).forEach(function(t){ka(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ka(e,a,r){return(a=Ma(a))in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e}function Ma(e){var a=Ka(e,"string");return typeof a=="symbol"?a:a+""}function Ka(e,a){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var t=r.call(e,a);if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}var $a=(e,a)=>a,ae=A([Pe,$a],(e,a)=>e.filter(r=>r.type==="pie").find(r=>r.id===a)),Wa=[],te=(e,a,r)=>(r==null?void 0:r.length)===0?Wa:r,xe=A([pe,ae,te],(e,a,r)=>{var{chartData:t}=e;if(a!=null){var n;if((a==null?void 0:a.data)!=null&&a.data.length>0?n=a.data:n=t,(!n||!n.length)&&r!=null&&(n=r.map(i=>ue(ue({},a.presentationProps),i.props))),n!=null)return n}}),Ba=A([xe,ae,te],(e,a,r)=>{if(!(e==null||a==null))return e.map((t,n)=>{var i,o=T(t,a.nameKey,a.name),m;return r!=null&&(i=r[n])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?m=r[n].props.fill:typeof t=="object"&&t!=null&&"fill"in t?m=t.fill:m=a.fill,{value:ge(o,a.dataKey),color:m,payload:t,type:a.legendType}})}),Fa=A([xe,ae,te,qe],(e,a,r,t)=>{if(!(a==null||e==null))return ct({offset:t,pieSettings:a,displayedData:e,cells:r})}),Ga=["key"],Va=["onMouseEnter","onClick","onMouseLeave"],Ua=["id"],Ya=["id"];function de(e,a){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function p(e){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?de(Object(r),!0).forEach(function(t){za(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function za(e,a,r){return(a=Za(a))in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e}function Za(e){var a=Ha(e,"string");return typeof a=="symbol"?a:a+""}function Ha(e,a){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var t=r.call(e,a);if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function R(){return R=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var t in r)({}).hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},R.apply(null,arguments)}function z(e,a){if(e==null)return{};var r,t,n=Xa(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)r=i[t],a.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Xa(e,a){if(e==null)return{};var r={};for(var t in e)if({}.hasOwnProperty.call(e,t)){if(a.indexOf(t)!==-1)continue;r[t]=e[t]}return r}function qa(e){var a=l.useMemo(()=>ye(e.children,ee),[e.children]),r=Q(t=>Ba(t,e.id,a));return r==null?null:l.createElement(aa,{legendPayload:r})}var Ja=l.memo(e=>{var{dataKey:a,nameKey:r,sectors:t,stroke:n,strokeWidth:i,fill:o,name:m,hide:g,tooltipType:f}=e,c={dataDefinedOnItem:t.map(d=>d.tooltipPayload),positions:t.map(d=>d.tooltipPosition),settings:{stroke:n,strokeWidth:i,fill:o,dataKey:a,nameKey:r,name:ge(m,a),hide:g,type:f,color:o,unit:""}};return l.createElement(ta,{tooltipEntrySettings:c})}),Qa=(e,a)=>e>a?"start":e<a?"end":"middle",et=(e,a,r)=>typeof a=="function"?W(a(e),r,r*.8):W(a,r,r*.8),at=(e,a,r)=>{var{top:t,left:n,width:i,height:o}=a,m=ga(i,o),g=n+W(e.cx,i,i/2),f=t+W(e.cy,o,o/2),c=W(e.innerRadius,m,0),d=et(r,e.outerRadius,m),s=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:g,cy:f,innerRadius:c,outerRadius:d,maxRadius:s}},tt=(e,a)=>{var r=V(a-e),t=Math.min(Math.abs(a-e),360);return r*t};function rt(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var nt=(e,a)=>{if(l.isValidElement(e))return l.cloneElement(e,a);if(typeof e=="function")return e(a);var r=q("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:t}=a,n=z(a,Ga);return l.createElement(ba,R({},n,{type:"linear",className:r}))},it=(e,a,r)=>{if(l.isValidElement(e))return l.cloneElement(e,a);var t=r;if(typeof e=="function"&&(t=e(a),l.isValidElement(t)))return t;var n=q("recharts-pie-label-text",rt(e));return l.createElement(ha,R({},a,{alignmentBaseline:"middle",className:n}),t)};function lt(e){var{sectors:a,props:r,showLabels:t}=e,{label:n,labelLine:i,dataKey:o}=r;if(!t||!n||!a)return null;var m=he(r),g=oe(n),f=oe(i),c=typeof n=="object"&&"offsetRadius"in n&&typeof n.offsetRadius=="number"&&n.offsetRadius||20,d=a.map((s,v)=>{var u=(s.startAngle+s.endAngle)/2,b=H(s.cx,s.cy,s.outerRadius+c,u),E=p(p(p(p({},m),s),{},{stroke:"none"},g),{},{index:v,textAnchor:Qa(b.x,s.cx)},b),D=p(p(p(p({},m),s),{},{fill:"none",stroke:s.fill},f),{},{index:v,points:[H(s.cx,s.cy,s.outerRadius,u),b],key:"line"});return l.createElement(Ae,{zIndex:be.label,key:"label-".concat(s.startAngle,"-").concat(s.endAngle,"-").concat(s.midAngle,"-").concat(v)},l.createElement(N,null,i&&nt(i,D),it(n,E,T(s,o))))});return l.createElement(N,{className:"recharts-pie-labels"},d)}function ot(e){var{sectors:a,props:r,showLabels:t}=e,{label:n}=r;return typeof n=="object"&&n!=null&&"position"in n?l.createElement(fa,{label:n}):l.createElement(lt,{sectors:a,props:r,showLabels:t})}function st(e){var{sectors:a,activeShape:r,inactiveShape:t,allOtherPieProps:n,shape:i}=e,o=Q(oa),{onMouseEnter:m,onClick:g,onMouseLeave:f}=n,c=z(n,Va),d=sa(m,n.dataKey),s=ca(f),v=ua(g,n.dataKey);return a==null||a.length===0?null:l.createElement(l.Fragment,null,a.map((u,b)=>{if((u==null?void 0:u.startAngle)===0&&(u==null?void 0:u.endAngle)===0&&a.length!==1)return null;var E=String(b)===o,D=o?t:null,_=r&&E?r:D,O=p(p({},u),{},{stroke:u.stroke,tabIndex:-1,[ma]:b,[da]:n.dataKey});return l.createElement(N,R({key:"sector-".concat(u==null?void 0:u.startAngle,"-").concat(u==null?void 0:u.endAngle,"-").concat(u.midAngle,"-").concat(b),tabIndex:-1,className:"recharts-pie-sector"},va(c,u,b),{onMouseEnter:d(u,b),onMouseLeave:s(u,b),onClick:v(u,b)}),l.createElement(pa,R({option:i??_,shapeType:"sector",isActive:E},O)))}))}function ct(e){var a,{pieSettings:r,displayedData:t,cells:n,offset:i}=e,{cornerRadius:o,startAngle:m,endAngle:g,dataKey:f,nameKey:c,tooltipType:d}=r,s=Math.abs(r.minAngle),v=tt(m,g),u=Math.abs(v),b=t.length<=1?0:(a=r.paddingAngle)!==null&&a!==void 0?a:0,E=t.filter(h=>T(h,f,0)!==0).length,D=(u>=360?E:E-1)*b,_=u-E*s-D,O=t.reduce((h,I)=>{var P=T(I,f,0);return h+(le(P)?P:0)},0),L;if(O>0){var x;L=t.map((h,I)=>{var P=T(h,f,0),j=T(h,c,I),S=at(r,i,h),k=(le(P)?P:0)/O,w,M=p(p({},h),n&&n[I]&&n[I].props);I?w=x.endAngle+V(v)*b*(P!==0?1:0):w=m;var F=w+V(v)*((P!==0?s:0)+k*_),K=(w+F)/2,re=(S.innerRadius+S.outerRadius)/2,Ie=[{name:j,value:P,payload:M,dataKey:f,type:d}],Te=H(S.cx,S.cy,re,K);return x=p(p(p(p({},r.presentationProps),{},{percent:k,cornerRadius:typeof o=="string"?parseFloat(o):o,name:j,tooltipPayload:Ie,midAngle:K,middleRadius:re,tooltipPosition:Te},M),S),{},{value:P,startAngle:w,endAngle:F,payload:M,paddingAngle:V(v)*b}),x})}return L}function ut(e){var{showLabels:a,sectors:r,children:t}=e,n=l.useMemo(()=>!a||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,a]);return l.createElement(la,{value:a?n:void 0},t)}function dt(e){var{props:a,previousSectorsRef:r}=e,{sectors:t,isAnimationActive:n,animationBegin:i,animationDuration:o,animationEasing:m,activeShape:g,inactiveShape:f,onAnimationStart:c,onAnimationEnd:d}=a,s=ra(a,"recharts-pie-"),v=r.current,[u,b]=l.useState(!1),E=l.useCallback(()=>{typeof d=="function"&&d(),b(!1)},[d]),D=l.useCallback(()=>{typeof c=="function"&&c(),b(!0)},[c]);return l.createElement(ut,{showLabels:!u,sectors:t},l.createElement(na,{animationId:s,begin:i,duration:o,isActive:n,easing:m,onAnimationStart:D,onAnimationEnd:E,key:s},_=>{var O=[],L=t&&t[0],x=L==null?void 0:L.startAngle;return t==null||t.forEach((h,I)=>{var P=v&&v[I],j=I>0?ia(h,"paddingAngle",0):0;if(P){var S=ie(P.endAngle-P.startAngle,h.endAngle-h.startAngle,_),k=p(p({},h),{},{startAngle:x+j,endAngle:x+S+j});O.push(k),x=k.endAngle}else{var{endAngle:w,startAngle:M}=h,F=ie(0,w-M,_),K=p(p({},h),{},{startAngle:x+j,endAngle:x+F+j});O.push(K),x=K.endAngle}}),r.current=O,l.createElement(N,null,l.createElement(st,{sectors:O,activeShape:g,inactiveShape:f,allOtherPieProps:a,shape:a.shape}))}),l.createElement(ot,{showLabels:!u,sectors:t,props:a}),a.children)}var mt={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!ea.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:be.area};function vt(e){var{id:a}=e,r=z(e,Ua),{hide:t,className:n,rootTabIndex:i}=e,o=l.useMemo(()=>ye(e.children,ee),[e.children]),m=Q(c=>Fa(c,a,o)),g=l.useRef(null),f=q("recharts-pie",n);return t||m==null?(g.current=null,l.createElement(N,{tabIndex:i,className:f})):l.createElement(Ae,{zIndex:e.zIndex},l.createElement(Ja,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:m,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType}),l.createElement(N,{tabIndex:i,className:f},l.createElement(dt,{props:p(p({},r),{},{sectors:m}),previousSectorsRef:g})))}function Oe(e){var a=J(e,mt),{id:r}=a,t=z(a,Ya),n=he(t);return l.createElement(Je,{id:r,type:"pie"},i=>l.createElement(l.Fragment,null,l.createElement(Qe,{type:"pie",id:i,data:t.data,dataKey:t.dataKey,hide:t.hide,angleAxisId:0,radiusAxisId:0,name:t.name,nameKey:t.nameKey,tooltipType:t.tooltipType,legendType:t.legendType,fill:t.fill,cx:t.cx,cy:t.cy,startAngle:t.startAngle,endAngle:t.endAngle,paddingAngle:t.paddingAngle,minAngle:t.minAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius,cornerRadius:t.cornerRadius,presentationProps:n,maxRadius:a.maxRadius}),l.createElement(qa,R({},t,{id:i})),l.createElement(vt,R({},t,{id:i}))))}Oe.displayName="Pie";function pt(e){var a=ya();return l.useEffect(()=>{a(Aa(e))},[a,e]),null}var ft=["layout"];function X(){return X=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var t in r)({}).hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},X.apply(null,arguments)}function gt(e,a){if(e==null)return{};var r,t,n=bt(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)r=i[t],a.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bt(e,a){if(e==null)return{};var r={};for(var t in e)if({}.hasOwnProperty.call(e,t)){if(a.indexOf(t)!==-1)continue;r[t]=e[t]}return r}var ht={top:5,right:5,bottom:5,left:5},yt={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:ht,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},At=l.forwardRef(function(a,r){var t,n=J(a.categoricalChartProps,yt),{layout:i}=n,o=gt(n,ft),{chartName:m,defaultTooltipEventType:g,validateTooltipEventTypes:f,tooltipPayloadSearcher:c}=a,d={chartName:m,defaultTooltipEventType:g,validateTooltipEventTypes:f,tooltipPayloadSearcher:c,eventEmitter:void 0};return l.createElement(Pa,{preloadedState:{options:d},reduxStoreName:(t=n.id)!==null&&t!==void 0?t:m},l.createElement(Ea,{chartData:n.data}),l.createElement(xa,{layout:i,margin:n.margin}),l.createElement(Oa,{baseValue:void 0,accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className,reverseStackOrder:n.reverseStackOrder}),l.createElement(pt,{cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius}),l.createElement(Ia,X({},o,{ref:r})))}),Pt=["item"],Et={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},xt=l.forwardRef((e,a)=>{var r=J(e,Et);return l.createElement(At,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Pt,tooltipPayloadSearcher:Ta,categoricalChartProps:r,ref:a})});const Ot=({active:e,payload:a})=>{const{formatCurrency:r}=me();return e&&a&&a.length?y.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-3 shadow-lg",children:[y.jsx("div",{className:"mb-1 font-semibold text-gray-900",children:a[0].name}),y.jsx("div",{className:"font-medium text-indigo-600",children:`${ve}${r(a[0].value,{minimumFractionDigits:0,maximumFractionDigits:0})}`})]}):null},wt=()=>{const{transactions:e,viewPeriod:a,selectedMonth:r,selectedYear:t}=Re(),{spendingByCategory:n}=Ce(e,a,r,t),{formatCurrency:i}=me(),o=De.useMemo(()=>Object.entries(n).map(([c,d])=>({name:c,value:d,color:je[c]||Z.COLORS[0]})).sort((c,d)=>d.value-c.value).slice(0,$.TOP_CATEGORIES),[n]),m=c=>{const d=(c.value/Object.values(n).reduce((s,v)=>s+v,0)*100).toFixed(1);return`${c.name}: ${d}%`},g=()=>{const c=Object.values(n).reduce((s,v)=>s+v,0),d=o.map(s=>({Category:s.name,Amount:s.value,Percentage:(s.value/c*100).toFixed(2)+"%"}));_e(d,"category_breakdown")},f=()=>{const c=Object.values(n).reduce((v,u)=>v+u,0),d=Math.min($.PREVIEW_ITEMS,o.length),s=o.slice(0,$.PREVIEW_ITEMS).map(v=>`${v.name}: ${ve}${i(v.value,{minimumFractionDigits:0,maximumFractionDigits:0})} (${(v.value/c*100).toFixed(1)}%)`).join(`
`);Le(`${G.CATEGORY_BREAKDOWN} (top ${d}):
${s}${o.length>$.PREVIEW_ITEMS?`
... and ${o.length-$.PREVIEW_ITEMS} more categories`:""}`,{autoClose:Se.TOAST_DETAILS})};return o.length===0?y.jsx(ne,{title:G.CATEGORY_BREAKDOWN,onRefresh:()=>window.location.reload(),children:y.jsx("div",{className:"py-8 text-center",children:y.jsx("p",{className:"text-sm text-gray-600",children:G.NO_SPENDING_DATA})})}):y.jsx(ne,{title:G.CATEGORY_BREAKDOWN,onExport:g,onViewDetails:f,onRefresh:()=>window.location.reload(),children:y.jsx(we,{height:Z.DEFAULT_CHART_HEIGHT,children:y.jsx(Ra,{width:"100%",height:"100%",children:y.jsxs(xt,{children:[y.jsx(Oe,{data:o,cx:"50%",cy:"50%",labelLine:!1,label:m,outerRadius:Z.PIE_OUTER_RADIUS,fill:"#8884d8",dataKey:"value",children:o.map((c,d)=>y.jsx(ee,{fill:c.color},`cell-${d}`))}),y.jsx(Ca,{content:y.jsx(Ot,{})}),y.jsx(Da,{})]})})})})};export{wt as default};
