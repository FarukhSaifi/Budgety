import{u as P,a as W,b as $,r as m,T as o,j as e,U as s,C as l,A as H}from"./index-8lZlQ1VF.js";import{u as U}from"./useDateFormatter-CGYOy8qr.js";import{B as p}from"./Button-BDqJC-5O.js";import{C,a as I,b as G}from"./Card-BGTWcXJa.js";import{C as Y}from"./ConfirmDialog-BN14OwTu.js";import{s as z}from"./toast-CFIaTDC2.js";import{E as X}from"./EditTransactionModal-D3_EUjHA.js";import"./DialogTitle-C94iNYoi.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./FormField-Bft-gaAM.js";import"./MenuItem-BWUw3nDk.js";const re=()=>{const{transactions:N,viewPeriod:O,selectedMonth:S,selectedYear:B,selectedCategory:h,searchQuery:F,dispatch:R}=P(),{filteredTransactions:b}=W(N,O,S,B,F),{formatCurrency:n}=$(),{formatDate:f}=U(),[_,w]=m.useState(null),[k,E]=m.useState(!1),[j,y]=m.useState({open:!1,transactionId:null}),u=m.useMemo(()=>h?b.filter(t=>t.category===h):b,[b,h]),T=t=>{y({open:!0,transactionId:t})},L=()=>{j.transactionId&&(R({type:H.DELETE_TRANSACTION,payload:j.transactionId}),z("Transaction deleted successfully"),y({open:!1,transactionId:null}))},v=t=>{w(t),E(!0)},M=()=>{E(!1),w(null)},d=m.useMemo(()=>[...u].sort((t,r)=>{const x=new Date(t.date),a=new Date(r.date);return x.getTime()===a.getTime()?new Date(t.createdAt||0)-new Date(r.createdAt||0):x-a}),[u]),c=m.useMemo(()=>{if(d.length===0)return 0;const t=new Date(d[0].date);return t.setHours(0,0,0,0),[...N.filter(a=>{if(!a.date)return!1;const i=new Date(a.date);return i.setHours(0,0,0,0),i<t})].sort((a,i)=>{const g=new Date(a.date),D=new Date(i.date);return g.getTime()===D.getTime()?new Date(a.createdAt||0)-new Date(i.createdAt||0):g-D}).reduce((a,i)=>{const g=i.amount||0;return i.type===o.INCOME?a+g:a-g},0)},[N,d]),A=m.useMemo(()=>d.reduce((t,r)=>{const x=r.amount||0,a=t.length>0?t[t.length-1].balance:c,i=r.type===o.INCOME?a+x:a-x;return t.push({...r,balance:i}),t},[]),[d,c]);return e.jsxs("div",{className:"mx-auto mb-2 md:mb-4",children:[e.jsxs("div",{className:"mb-2 md:mb-4",children:[e.jsx("h2",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-gray-800 mb-1 sm:mb-2",children:s.TRANSACTIONS}),e.jsx("p",{className:"text-gray-600 text-xs sm:text-sm md:text-base",children:s.VIEW_AND_MANAGE_TRANSACTIONS})]}),u.length===0?e.jsx(C,{children:e.jsx(I,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("i",{className:"ion-information-circled text-4xl text-blue-500 mb-3"}),e.jsx("p",{className:"text-gray-700 font-medium",children:s.NO_TRANSACTIONS})]})})}):e.jsxs(C,{children:[e.jsx(G,{bgColor:"bg-blue-500",children:e.jsxs("h5",{className:"text-sm sm:text-base md:text-lg font-semibold break-words",children:[e.jsxs("span",{className:"block sm:inline",children:[s.BANK_STATEMENT," - ",u.length," ",s.TRANSACTION_S]}),h&&e.jsxs("span",{className:"block sm:inline sm:ml-1 text-xs sm:text-sm font-normal opacity-90",children:["(",s.FILTERED,": ",h,")"]})]})}),e.jsxs(I,{className:"p-0",children:[e.jsx("div",{className:"hidden lg:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center text-xs font-semibold text-gray-700 uppercase tracking-wider w-16",children:s.S_NO}),e.jsx("th",{className:"text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:s.DATE}),e.jsx("th",{className:"text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:s.MODE}),e.jsx("th",{className:"text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:s.PARTICULARS}),e.jsx("th",{className:"text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:s.DEPOSITS}),e.jsx("th",{className:"text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:s.WITHDRAWALS}),e.jsx("th",{className:"text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:s.BALANCE}),e.jsx("th",{className:"text-center text-xs font-semibold text-gray-700 uppercase tracking-wider",children:s.ACTION})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[c!==0&&d.length>0&&e.jsxs("tr",{className:"bg-blue-50 border-b-2 border-blue-200",children:[e.jsx("td",{className:"whitespace-nowrap text-center text-sm text-gray-600 font-medium",children:"-"}),e.jsx("td",{className:"whitespace-nowrap text-sm text-gray-700 italic",children:s.OPENING_BALANCE}),e.jsx("td",{className:"whitespace-nowrap text-sm text-gray-700",children:"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 italic",children:s.BALANCE_BROUGHT_FORWARD}),e.jsx("td",{className:"whitespace-nowrap text-right text-sm font-semibold text-gray-600",children:"-"}),e.jsx("td",{className:"whitespace-nowrap text-right text-sm font-semibold text-gray-600",children:"-"}),e.jsxs("td",{className:"whitespace-nowrap text-right text-sm font-semibold text-gray-800",children:[l,n(c,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("td",{className:"whitespace-nowrap text-center",children:"-"})]}),A.map((t,r)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"whitespace-nowrap text-center text-sm text-gray-600 font-medium",children:r+1}),e.jsx("td",{className:"whitespace-nowrap text-sm text-gray-900",children:f(t.date,"short")}),e.jsx("td",{className:"whitespace-nowrap text-sm text-gray-700",children:e.jsx("span",{className:"text-xs font-medium bg-gray-100 text-gray-800 rounded",children:t.mode||s.NOT_AVAILABLE})}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs",children:[e.jsx("div",{className:"font-medium truncate",title:t.description,children:t.description}),t.category&&e.jsx("div",{className:"text-xs text-gray-500 mt-0.5 truncate",children:t.category})]}),e.jsx("td",{className:"whitespace-nowrap text-right text-sm font-semibold text-green-600",children:t.type===o.INCOME?`${l}${n(t.amount,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"-"}),e.jsx("td",{className:"whitespace-nowrap text-right text-sm font-semibold text-red-600",children:t.type===o.EXPENSE?`${l}${n(t.amount,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"-"}),e.jsxs("td",{className:"whitespace-nowrap text-right text-sm font-semibold text-gray-800",children:[l,n(t.balance,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("td",{className:"whitespace-nowrap text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>v(t),className:"text-blue-500 hover:text-blue-700 hover:bg-blue-50 p-1.5 min-w-[32px]",title:s.EDIT,children:e.jsx("i",{className:"ion-edit text-base md:text-lg"})}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>T(t.id),className:"text-red-500 hover:text-red-700 hover:bg-red-50 p-1.5 min-w-[32px]",title:s.DELETE,children:e.jsx("i",{className:"ion-close-round text-base md:text-lg"})})]})})]},t.id))]})]})}),e.jsxs("div",{className:"lg:hidden divide-y divide-gray-200",children:[c!==0&&d.length>0&&e.jsx("div",{className:"p-2 md:p-4 bg-blue-50 border-b-2 border-blue-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm sm:text-base text-gray-800 mb-1",children:s.OPENING_BALANCE}),e.jsx("div",{className:"text-xs text-gray-600 italic",children:s.BALANCE_BROUGHT_FORWARD})]}),e.jsxs("div",{className:"text-sm sm:text-base font-semibold text-gray-800",children:[l,n(c,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})}),A.map(t=>e.jsxs("div",{className:"p-2 md:p-4 hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2 gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm sm:text-base text-gray-900 mb-1 break-words line-clamp-2",children:t.description}),e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:f(t.date,"short")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.mode&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded",children:t.mode}),t.category&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded",children:t.category})]})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>v(t),className:"text-blue-500 hover:text-blue-700 active:text-blue-800 p-2 touch-manipulation",title:s.EDIT,children:e.jsx("i",{className:"ion-edit text-base"})}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>T(t.id),className:"text-red-500 hover:text-red-700 active:text-red-800 p-2 touch-manipulation",title:s.DELETE,children:e.jsx("i",{className:"ion-close-round text-base"})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2 md:mt-4 pt-2 md:pt-4 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:s.DEPOSITS}),e.jsx("div",{className:"text-sm sm:text-base font-semibold text-green-600 break-words",children:t.type===o.INCOME?`${l}${n(t.amount,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:s.WITHDRAWALS}),e.jsx("div",{className:"text-sm sm:text-base font-semibold text-red-600 break-words",children:t.type===o.EXPENSE?`${l}${n(t.amount,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:s.BALANCE}),e.jsxs("div",{className:"text-sm sm:text-base font-semibold text-gray-800 break-words",children:[l,n(t.balance,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]},t.id))]})]})]}),e.jsx(X,{open:k,onClose:M,transaction:_}),e.jsx(Y,{open:j.open,onClose:()=>y({open:!1,transactionId:null}),onConfirm:L,title:s.DELETE_TRANSACTION_TITLE,message:s.CONFIRM_DELETE_TRANSACTION,type:"warning",variant:"danger",confirmText:s.DELETE})]})};export{re as default};
